{"ast":null,"code":"import { Octokit } from '@octokit/core';\nimport { call, put, takeLatest } from \"redux-saga/effects\";\nimport { refreshPageFail, refreshPageStart, refreshPageSuccess } from '../actions/refresh-page';\nimport types from '../types';\nexport const httpCall = ({\n  owner,\n  repo\n}) => {\n  const octokit = new Octokit({\n    auth: process.env.REACT_APP_AUTHORIZATION\n  });\n  return octokit.request('GET /repos/{owner}/{repo}/releases/latest', {\n    owner,\n    repo\n  }).then(response => {\n    return response.data;\n  }).catch(err => console.log(err));\n};\n\nfunction* refreshPage({\n  repos\n}) {\n  try {\n    yield put(refreshPageStart());\n    let newReleases = [];\n\n    for (let i = 0; i < repos.length; ++i) {\n      const owner = repos[i].data.owner.login;\n      const repo = repos[i].data.name;\n      let result = yield call(httpCall, {\n        owner,\n        repo\n      }); // console.log(deepEqual(result, repo.notes));\n      // console.log(JSON.stringify(result) === repos[i].notes);\n      // console.log(JSON.stringify(repos[i].notes));\n\n      newReleases.push(result);\n    }\n\n    yield put(refreshPageSuccess(newReleases));\n  } catch (err) {\n    yield put(refreshPageFail(err));\n  }\n}\n\nfunction deepEqual(object1, object2) {\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (keys1.length !== keys2.length) {\n    return false;\n  }\n\n  for (const key of keys1) {\n    const val1 = object1[key];\n    const val2 = object2[key];\n    const areObjects = isObject(val1) && isObject(val2);\n\n    if (areObjects && !deepEqual(val1, val2) || !areObjects && val1 !== val2) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isObject(object) {\n  return object != null && typeof object === 'object';\n}\n\nexport default function* refreshPageSaga() {\n  yield takeLatest(types.REFRESH_PAGE, refreshPage);\n}","map":{"version":3,"sources":["/Users/JGhidossi/Downloads/lumanu-interview/src/modules/search/sagas/refresh-page.js"],"names":["Octokit","call","put","takeLatest","refreshPageFail","refreshPageStart","refreshPageSuccess","types","httpCall","owner","repo","octokit","auth","process","env","REACT_APP_AUTHORIZATION","request","then","response","data","catch","err","console","log","refreshPage","repos","newReleases","i","length","login","name","result","push","deepEqual","object1","object2","keys1","Object","keys","keys2","key","val1","val2","areObjects","isObject","object","refreshPageSaga","REFRESH_PAGE"],"mappings":"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","sourcesContent":["import {Octokit} from '@octokit/core';\nimport {call, put, takeLatest} from \"redux-saga/effects\";\nimport {refreshPageFail, refreshPageStart, refreshPageSuccess} from '../actions/refresh-page';\nimport types from '../types';\n\nexport const httpCall = ({owner, repo}) => {\n    const octokit = new Octokit({auth: process.env.REACT_APP_AUTHORIZATION});\n    return octokit.request('GET /repos/{owner}/{repo}/releases/latest', {\n        owner,\n        repo,\n    }).then((response) => {\n        return response.data;\n    }).catch((err) => console.log(err));\n}\n\nfunction* refreshPage({repos}) {\n    try {\n        yield put(refreshPageStart());\n\n        let newReleases = [];\n        for (let i = 0; i < repos.length; ++i) {\n            const owner = repos[i].data.owner.login;\n            const repo = repos[i].data.name;\n            let result = yield call(httpCall, {owner, repo});\n            // console.log(deepEqual(result, repo.notes));\n            // console.log(JSON.stringify(result) === repos[i].notes);\n            // console.log(JSON.stringify(repos[i].notes));\n            newReleases.push(result);\n        }\n\n        yield put(refreshPageSuccess(newReleases));\n    } catch (err) {\n        yield put(refreshPageFail(err));\n    }\n}\n\nfunction deepEqual(object1, object2) {\n    const keys1 = Object.keys(object1);\n    const keys2 = Object.keys(object2);\n\n    if (keys1.length !== keys2.length) {\n        return false;\n    }\n\n    for (const key of keys1) {\n        const val1 = object1[key];\n        const val2 = object2[key];\n        const areObjects = isObject(val1) && isObject(val2);\n        if ((areObjects && !deepEqual(val1, val2)) || (!areObjects && val1 !== val2)) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction isObject(object) {\n    return object != null && typeof object === 'object';\n}\n\nexport default function* refreshPageSaga() {\n    yield takeLatest(types.REFRESH_PAGE, refreshPage);\n}\n"]},"metadata":{},"sourceType":"module"}